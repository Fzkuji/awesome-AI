# Papers



### PrefRec: Recommender Systems with Human Preferences for Reinforcing Long-term User Engagement

| Name    | Paper                                                                                             | Publication    | Repository | Link                                                 | Classification                            |
| ------- | ------------------------------------------------------------------------------------------------- | -------------- | ---------- | ---------------------------------------------------- | ----------------------------------------- |
| PrefRec | [[#PrefRec Recommender Systems with Human Preferences for Reinforcing Long-term User Engagement]] | arXiv preprint |            | [arXiv:2212.02779](https://arxiv.org/abs/2212.02779) |  |

> 作者提出了一个新的推荐系统范例，名为PrefRec，它允许强化学习推荐系统从用户历史行为的偏好中学习，而不是从明确定义的奖励中学习。这样，他们可以充分利用强化学习在优化长期目标方面的优势，同时避免复杂的奖励工程。
> 
> 他们的实验目标包括优化会话深度，访问频率，以及两者的混合。他们使用了标准化的重要性抽样（NCIS）作为评价指标，这是一种广泛使用的标准离线评估方法，用于评估推荐系统的性能。
> 
> 实验结果显示，尽管PrefRec没有收到任何明确的强化信号，但在所有任务中，它在累积变化级别上都表现出了优越的性能，这表明PrefRec成功地优化了长期用户参与度。


RLHF用于训练基于强化学习的推荐系统，针对的问题是长期用户参与度，评价指标是重要性抽样（NCIS），结果是RLHF训练的奖励模型比设计好的奖励函数更好。

在PrefRec模型中，推荐策略是通过强化学习来解决的。具体来说，作者使用了一个基于行动者-评论者（Actor-Critic）的强化学习方法来训练推荐策略。


**Q1: 这篇文章实验中如何判断模型的好坏？depth和frequency又是什么？**

在这篇文章的实验部分，作者主要通过以下几个研究问题（RQs）来评估他们的算法：

- RQ1: PrefRec框架能否提高长期用户参与度？
- RQ2: PrefRec能否超越现有的最先进的方法？
- RQ3: 学习到的奖励信号能否反映真实的潜在奖励？
- RQ4: PrefRec中的各个组件如何贡献到性能？

为了回答这些问题，作者收集了一个大规模的数据集，包括约100,000名用户在几个月内的完整交互历史，期间提供了超过25万次的推荐服务。

在这个数据集中，每个用户的交互历史都被记录下来，包括多个会话，每个会话包含多个推荐请求。每个状态是一个245维的向量，包含用户的状态信息，如性别、年龄和历史喜欢率。每个动作是一个8维的向量，表示在一个请求中推荐的项目。

作者使用会话深度（session depth）和访问频率（visiting frequency）来衡量长期用户参与度的变化。会话深度是指一个会话中的请求数量，如果一个会话的深度大于用户的平均会话深度，那么就认为会话深度有所提高。访问频率是指用户重新访问平台的频率，如果一个会话的访问频率小于用户的平均访问频率，那么就认为访问频率有所提高。

这两个指标被量化为六个等级（从0到5，等级越高，变化越积极）。这些等级是通过以下公式确定的：

```
Level = floor((current - average) / std_dev)
```

其中，`current` 是当前会话的深度或访问频率，`average` 是用户的平均会话深度或访问频率，`std_dev` 是会话深度或访问频率的标准差，`floor` 是向下取整函数。

- "depth"（深度）：这是指一个会话中的请求数量。如果一个会话的深度大于用户的平均会话深度，那么就认为会话深度有所提高。
- "frequency"（频率）：这是指用户重新访问平台的频率。如果一个会话的重新访问时间小于用户的平均重新访问时间，那么就认为访问频率有所提高。

总的来说，作者通过比较PrefRec和其他方法在这些指标上的表现，来评估PrefRec的性能。