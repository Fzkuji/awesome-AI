

## Models

### FM

Factorization Machine（简称FM，或称因子分解机）是一种用于预测和推荐的通用模型。它是线性模型和矩阵分解（Matrix Factorization）的扩展，因此能够有效地处理稀疏数据。

#### 基本公式

FM模型的预测公式如下：

$$
\hat{y}(x) = w_0 + \sum_{i=1}^{n} w_i x_i + \sum_{i=1}^{n} \sum_{j=i+1}^{n} \langle v_i, v_j \rangle x_i x_j
$$

其中：

- $\hat{y}(x)$是预测值。
- $w_0, w_i$是线性参数。
- $v_i, v_j$是因子向量。
- $\langle v_i, v_j \rangle$表示因子向量的点积。
- $x_i, x_j$是特征。

这个公式由三部分组成：

1. 常数项$w_0$
    - 这是模型的截距，也就是当所有特征都为0时的预测值
2. 线性项$\sum_{i=1}^{n} w_i x_i$
    - 这部分是传统线性模型的组成部分，其中$w_i$是第$i$个特征的权重，$x_i$是第$i$个特征的值
3. **交互项**$\sum_{i=1}^{n} \sum_{j=i+1}^{n} \langle v_i, v_j \rangle x_i x_j$
    - 这部分是FM模型的**核心**，用于捕捉特征之间的交互
    - $\langle v_i, v_j \rangle$是第$i$个和第$j$个特征的因子向量的点积
    - $x_i$和$x_j$是相应特征的值

##### 解释因子向量$v$

- 因子向量$v$是FM模型中用于表示特征的低维嵌入（embedding）。
- 点积$\langle v_i, v_j \rangle$表示两个特征$i$和$j$如何相互影响。这是FM模型相对于普通线性模型的一个重要优势。

假设我们有一个简单的电影推荐问题，特征包括用户ID和电影ID。在这种情况下，线性模型只能捕捉每个用户或每部电影的独立效应，而不能捕捉用户和电影之间的交互效应。

但在FM模型中，通过因子向量和它们的点积，我们可以模拟用户和电影之间的交互，从而进行更准确的推荐。

#### 主要特点

1. **高效性**：FM模型可以在线性时间内完成训练和预测。
2. **灵活性**：适用于回归、分类和排序等多种任务。
3. **处理稀疏数据**：能有效处理具有大量缺失值或稀疏特征的数据。

#### 应用场景

- 推荐系统
- 点击率预测（CTR Prediction）
- 特征组合

#### 举个例子

假设你有一个电影推荐系统，特征包括用户ID、电影ID和其他上下文信息。传统的线性模型可能无法捕捉用户和电影之间的复杂交互，但FM模型通过因子向量来模拟这种交互，从而更准确地进行推荐。













