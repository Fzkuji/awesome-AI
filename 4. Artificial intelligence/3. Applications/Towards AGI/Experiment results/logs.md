记忆整合长度：8 token
不使用lora
batch size = 1，17777mb显存；

Evaluating val loss: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [12:34<00:00,  3.77s/it]
step 20: train loss 5.3188, val loss 5.3075, train perplexity 204.1383, val perplexity 201.8479
train segment loss: tensor([5.3174, 5.3320, 4.9483, 5.3134, 5.1852, 4.9539, 5.1260, 5.0731, 4.8556,
        4.9590, 5.0131, 4.9125, 5.1077, 4.8853, 4.8543, 5.0082, 5.0257, 5.0412,
        5.0280, 5.1083, 5.0981, 5.1692, 5.0171, 4.9955, 5.0427, 5.1742, 5.0996,
        5.2080, 5.0862, 5.1948, 5.0473, 5.0295, 4.9736, 5.0167, 5.0391, 5.0740,
        5.0221, 4.9250, 5.0104, 5.1869, 5.1339, 5.1414, 5.2723, 5.0733, 5.1289,
        5.2546, 5.2854, 5.3454, 5.2678, 5.2506, 5.3377, 5.3038, 5.3333, 5.4778,
        5.2577, 5.3405, 5.2378, 5.4479, 5.3207, 5.3366, 5.4986, 5.3567, 5.2091,
        5.3291, 5.2440, 5.3053, 5.4136, 5.2346, 5.4473, 5.4930, 5.1279, 5.2747,
        5.3610, 5.1480, 5.2793, 5.3272, 5.4680, 5.2430, 5.5499, 5.4377, 5.3076,
        5.1738, 5.3166, 5.3769, 5.1971, 5.4273, 5.4035, 5.4026, 5.3804, 5.3884,
        5.4595, 5.3477, 5.2993, 5.2871, 5.3779, 5.4161, 5.4095, 5.0942, 5.2376,
        5.4575, 5.3000, 5.5161, 5.4690, 5.2936, 5.3172, 5.2665, 5.4019, 5.5368,
        5.3848, 5.3140, 5.4091, 5.3162, 5.4885, 5.3328, 5.2365, 5.2878, 5.2708,
        5.2346, 5.4290, 5.3406, 5.2686, 5.2352, 5.3956, 5.5215, 5.3402, 5.3391,
        5.5526, 5.4484], device='cuda:0'), val segment loss: tensor([5.6442, 5.3128, 5.1950, 5.0382, 5.0858, 5.0299, 5.2752, 5.3342, 5.0128,
        4.9516, 5.1260, 5.1368, 5.2506, 5.1374, 5.1829, 5.1217, 5.2141, 4.9955,
        5.0842, 5.1154, 5.0520, 5.3545, 5.4289, 5.1599, 5.1460, 5.3801, 5.2512,
        4.9975, 5.1001, 5.2855, 5.1116, 5.2517, 5.1671, 5.1749, 4.9720, 5.5601,
        5.1621, 5.2058, 5.0602, 5.1985, 5.4319, 5.2869, 5.2802, 5.3974, 5.4219,
        5.0631, 5.3268, 5.2164, 5.2616, 5.1880, 5.2822, 5.3835, 5.3042, 5.4166,
        5.1904, 5.5620, 5.3625, 5.2984, 5.2804, 5.3758, 5.4827, 5.3125, 5.5890,
        5.3665, 5.4221, 5.2716, 5.2145, 5.2573, 5.3782, 5.2668, 5.5206, 5.3906,
        5.3875, 5.4303, 5.3536, 5.5506, 5.2900, 5.2734, 5.4176, 5.3685, 5.3943,
        5.4610, 5.4469, 5.4660, 5.3797, 5.4149, 5.5731, 5.3262, 5.4930, 5.3235,
        5.2430, 5.2498, 5.2455, 5.1819, 5.2432, 5.5023, 5.5240, 5.5683, 5.3293,
        5.4560, 5.5821, 5.3732, 5.4035, 5.3606, 5.4904, 5.4620, 5.3566, 5.4325,
        5.6933, 5.4768, 5.1937, 5.3205, 5.3633, 5.2259, 5.0820, 5.3697, 5.3694,
        5.4782, 5.5175, 5.5485, 5.3548, 5.1711, 5.3813, 5.6823, 5.3824, 5.4569,
        5.7581, 5.5506], device='cuda:0')
saving checkpoint to out-owt with name ckpt.pt
iter 20: loss 5.2765, time 2064182.78ms, mfu 0.00%
Evaluating train loss: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [13:19<00:00,  4.00s/it]
Evaluating val loss: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [13:06<00:00,  3.93s/it]
step 30: train loss 4.7043, val loss 4.7004, train perplexity 110.4172, val perplexity 109.9916
train segment loss: tensor([5.1889, 5.2211, 4.9066, 4.8096, 4.6955, 4.7138, 4.6103, 4.6636, 4.7450,
        4.7028, 4.7181, 4.5374, 4.5084, 4.6398, 4.5585, 4.5163, 4.5982, 4.7053,
        4.4588, 4.5938, 4.6628, 4.5875, 4.5489, 4.5965, 4.6272, 4.8054, 4.6705,
        4.4954, 4.4377, 4.6738, 4.6478, 4.5011, 4.5516, 5.0623, 4.5756, 4.6010,
        4.8387, 4.5523, 4.6219, 4.6562, 4.6050, 4.7503, 4.6501, 4.7025, 4.6143,
        4.6094, 4.6150, 4.7623, 4.7252, 4.5196, 4.7063, 4.8360, 4.8093, 4.7185,
        4.9768, 4.6946, 4.5698, 4.7460, 4.6972, 4.5677, 4.6719, 4.6513, 4.8387,
        4.8896, 4.7035, 4.6650, 4.7283, 4.8536, 4.5777, 4.7160, 4.6761, 4.6386,
        4.5799, 4.7204, 4.8244, 4.7447, 4.7344, 4.6899, 4.7725, 4.7390, 4.6339,
        4.7416, 4.6815, 4.7587, 4.5540, 4.5710, 4.6626, 4.7087, 4.6124, 4.7451,
        4.8425, 4.5989, 4.4327, 4.7494, 4.6255, 4.6440, 4.6493, 4.5998, 4.8039,
        4.6551, 4.7713, 4.8296, 4.7288, 4.6010, 4.6488, 4.8364, 4.7860, 4.7705,
        4.6971, 4.7453, 4.6893, 4.6079, 4.7461, 4.7342, 4.7938, 4.7016, 4.6867,
        4.7096, 4.7772, 4.6448, 4.7714, 4.6610, 4.5577, 4.8815, 4.7250, 4.6242,
        4.8378, 4.7887], device='cuda:0'), val segment loss: tensor([5.4310, 5.1063, 4.7548, 4.7547, 4.5360, 4.5682, 4.5941, 4.8187, 4.8206,
        4.7699, 4.6115, 4.4474, 4.4321, 4.6107, 4.6451, 4.5497, 4.6947, 4.6518,
        4.5794, 4.6322, 4.5273, 4.8016, 4.5985, 4.4998, 4.5556, 4.6444, 4.7449,
        4.5673, 4.5171, 4.6419, 4.5069, 4.5715, 4.6090, 4.5978, 4.3859, 4.5024,
        4.5927, 4.7097, 4.9173, 4.5680, 4.6647, 4.5159, 4.7824, 4.3147, 4.7301,
        4.6712, 4.6198, 4.7458, 4.6803, 4.5859, 4.6455, 4.7091, 4.6189, 4.6723,
        4.6576, 4.7402, 4.6935, 4.9176, 4.6091, 4.8603, 4.6806, 4.7185, 4.6350,
        4.8737, 4.6758, 4.7202, 5.1201, 4.7730, 4.7733, 4.6385, 4.6248, 4.6771,
        4.8116, 4.7242, 4.7331, 4.7895, 4.8628, 4.7503, 4.6555, 4.7897, 4.8971,
        4.7530, 4.7920, 4.6298, 4.7533, 4.7896, 4.9800, 4.7489, 4.8149, 4.5672,
        4.8332, 4.8732, 4.7534, 4.6880, 4.7578, 4.7763, 4.7364, 4.5755, 4.8409,
        5.0107, 4.6713, 4.7901, 4.7704, 4.6795, 4.8399, 4.8088, 4.8518, 4.9554,
        4.8672, 4.8259, 4.7505, 4.8854, 4.7358, 5.0038, 4.6722, 4.7729, 4.8239,
        4.4622, 4.6607, 4.8370, 4.7954, 4.6624, 4.4928, 4.7257, 4.6448, 4.6515,
        4.6320, 4.8302], device='cuda:0')
saving checkpoint to out-owt with name ckpt.pt
iter 30: loss 4.7407, time 2177531.14ms, mfu 0.00%
Evaluating train loss: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [13:04<00:00,  3.92s/it]
Evaluating val loss: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [13:00<00:00,  3.90s/it]
step 40: train loss 4.5030, val loss 4.4750, train perplexity 90.2913, val perplexity 87.7982
train segment loss: tensor([5.4251, 4.8089, 4.5386, 4.5301, 4.4938, 4.6470, 4.5358, 4.5640, 4.5557,
        4.7588, 4.6053, 4.5465, 4.6739, 4.4178, 4.4426, 4.4755, 4.7022, 4.5693,
        4.3754, 4.3629, 4.3494, 4.4608, 4.5652, 4.4572, 4.3976, 4.2681, 4.3890,
        4.4263, 4.5230, 4.5313, 4.4223, 4.7157, 4.5873, 4.5347, 4.4223, 4.4188,
        4.7098, 4.4151, 4.3334, 4.2369, 4.4561, 4.4895, 4.4517, 4.4943, 4.5773,
        4.6718, 4.5095, 4.3706, 4.4590, 4.5867, 4.5837, 4.5587, 4.4451, 4.4270,
        4.6048, 4.5990, 4.5445, 4.5769, 4.5976, 4.6318, 4.4996, 4.4821, 4.4929,
        4.5287, 4.6336, 4.4659, 4.4865, 4.5244, 4.5953, 4.7015, 4.7211, 4.4975,
        4.5621, 4.5877, 4.5299, 4.6259, 4.4344, 4.5739, 4.4872, 4.5475, 4.7768,
        4.5337, 4.5132, 4.5163, 4.3806, 4.5702, 4.3518, 4.5095, 4.6937, 4.3452,
        4.6056, 4.6988, 4.4173, 4.7810, 4.4444, 4.3562, 4.5362, 4.6456, 4.5814,
        4.5262, 4.5917, 4.6042, 4.4449, 4.5001, 4.5760, 4.5458, 4.6152, 4.6717,
        4.6425, 4.5528, 4.6087, 4.5790, 4.5557, 4.4309, 4.5830, 4.5504, 4.4611,
        4.2236, 4.6350, 4.5720, 4.6237, 4.6555, 4.3813, 4.6094, 4.4187, 4.4261,
        4.3705, 4.4468], device='cuda:0'), val segment loss: tensor([5.1881, 4.6097, 4.4211, 4.4453, 4.3841, 4.4258, 4.2800, 4.4599, 4.4637,
        4.5473, 4.4836, 4.2594, 4.4284, 4.4036, 4.2799, 4.3270, 4.1477, 4.2809,
        4.3636, 4.3502, 4.3117, 4.4666, 4.3155, 4.2202, 4.3653, 4.3821, 4.2980,
        4.5358, 4.4372, 4.2643, 4.2380, 4.2973, 4.0974, 4.4667, 4.4159, 4.5585,
        4.2950, 4.5861, 4.6504, 4.2634, 4.4126, 4.2629, 4.4915, 4.5233, 4.4378,
        4.5291, 4.2637, 4.4173, 4.5225, 4.2539, 4.4140, 4.4185, 4.2908, 4.2841,
        4.4447, 4.5174, 4.2690, 4.4653, 4.2806, 4.3161, 4.4495, 4.4734, 4.4540,
        4.3556, 4.2960, 4.3247, 4.3977, 4.7457, 4.4980, 4.4081, 4.4939, 4.4980,
        4.5238, 4.5513, 4.5791, 4.6693, 4.5292, 4.6259, 4.5549, 4.5961, 4.5849,
        4.3404, 4.2839, 4.2271, 4.3882, 4.5399, 4.5622, 4.4983, 4.5597, 4.4710,
        4.4602, 4.3785, 4.3956, 4.4197, 4.5440, 4.2862, 4.4647, 4.4812, 4.5783,
        4.4928, 4.3501, 4.3789, 4.5179, 4.4557, 4.6308, 4.3360, 4.4985, 4.3146,
        4.4099, 4.2397, 4.4013, 4.3641, 4.5822, 4.4481, 4.4651, 4.5344, 4.3923,
        4.5123, 4.2971, 4.5573, 4.4304, 4.4754, 4.3265, 4.5769, 4.4889, 4.3093,
        4.3437, 4.4513], device='cuda:0')
saving checkpoint to out-owt with name ckpt.pt
iter 40: loss 4.2474, time 2141937.55ms, mfu 0.00%